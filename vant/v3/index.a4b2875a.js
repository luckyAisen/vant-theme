import{c as E,B as G,l as U,h as q,G as J}from"./use-translate.7145ee20.js";import{n as H,m as B,c as K,t as L,a as O,w as Q}from"./with-install.756837d9.js";import{u as W}from"./use-refs.a0d96d45.js";import{u as Y}from"./use-touch.a752672a.js";import{I as T}from"./index.bea91046.js";import{z as Z,C as $,e as d}from"./vue-libs.84e059bd.js";const[x,f]=E("rate");function p(e,o,l,i){if(e>=o)return{status:"full",value:1};if(e+.5>=o&&l&&!i)return{status:"half",value:.5};if(e+1>=o&&l&&i){const u=10**10;return{status:"half",value:Math.round((e-o+1)*u)/u}}return{status:"void",value:0}}const ee={size:H,icon:B("star"),color:String,count:K(5),gutter:H,readonly:Boolean,disabled:Boolean,voidIcon:B("star-o"),allowHalf:Boolean,voidColor:String,touchable:L,iconPrefix:String,modelValue:O(0),disabledColor:String};var ae=Z({name:x,props:ee,emits:["change","update:modelValue"],setup(e,{emit:o}){const l=Y(),[i,u]=W(),b=()=>e.readonly||e.disabled||!e.touchable,N=$(()=>Array(+e.count).fill("").map((a,t)=>p(e.modelValue,t+1,e.allowHalf,e.readonly)));let s;const v=()=>{const a=i.value.map(J);s=[],a.forEach((t,n)=>{e.allowHalf?s.push({score:n+.5,left:t.left},{score:n+1,left:t.left+t.width/2}):s.push({score:n+1,left:t.left})})},g=a=>{for(let t=s.length-1;t>0;t--)if(a>s[t].left)return s[t].score;return e.allowHalf?.5:1},y=a=>{!e.disabled&&!e.readonly&&a!==e.modelValue&&(o("update:modelValue",a),o("change",a))},F=a=>{b()||(l.start(a),v())},M=a=>{if(!b()&&(l.move(a),l.isHorizontal())){const{clientX:t}=a.touches[0];U(a),y(g(t))}},X=(a,t)=>{const{icon:n,size:P,color:R,count:w,gutter:C,voidIcon:S,disabled:r,voidColor:V,allowHalf:k,iconPrefix:z,disabledColor:I}=e,m=t+1,h=a.status==="full",c=a.status==="void",_=k&&a.value>0&&a.value<1;let j;C&&m!==+w&&(j={paddingRight:q(C)});const A=D=>{v(),y(k?g(D.clientX):m)};return d("div",{key:t,ref:u(t),role:"radio",style:j,class:f("item"),tabindex:r?void 0:0,"aria-setsize":w,"aria-posinset":m,"aria-checked":!c,onClick:A},[d(T,{size:P,name:h?n:S,class:f("icon",{disabled:r,full:h}),color:r?I:h?R:V,classPrefix:z},null),_&&d(T,{size:P,style:{width:a.value+"em"},name:c?S:n,class:f("icon",["half",{disabled:r,full:!c}]),color:r?I:c?V:R,classPrefix:z},null)])};return G(()=>e.modelValue),()=>d("div",{role:"radiogroup",class:f({readonly:e.readonly,disabled:e.disabled}),tabindex:e.disabled?void 0:0,"aria-disabled":e.disabled,"aria-readonly":e.readonly,onTouchstart:F,onTouchmove:M},[N.value.map(X)])}});const ie=Q(ae);export{ie as R};
