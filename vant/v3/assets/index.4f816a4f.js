import{c as B,i as d,f as u,a as E}from"./use-translate.33b17133.js";import{n as l,t as L,m as z,w as $}from"./with-install.d00852e2.js";import{I as C}from"./index.0a08d1ef.js";import{z as D,C as f,I as U,B as N,x as R,O as k,e as a,j as F,U as H,H as P}from"./vue-libs.7d3cdfcb.js";const[O,o]=B("image"),V={src:String,alt:String,fit:String,round:Boolean,width:l,height:l,radius:l,lazyLoad:Boolean,iconSize:l,showError:L,errorIcon:z("photo-fail"),iconPrefix:String,showLoading:L,loadingIcon:z("photo")};var _=D({name:O,props:V,emits:["load","error"],setup(r,{emit:g,slots:n}){const i=f(!1),t=f(!0),c=f(),{$Lazyload:s}=U().proxy,x=N(()=>{const e={};return d(r.width)&&(e.width=u(r.width)),d(r.height)&&(e.height=u(r.height)),d(r.radius)&&(e.overflow="hidden",e.borderRadius=u(r.radius)),e});R(()=>r.src,()=>{i.value=!1,t.value=!0});const m=e=>{t.value=!1,g("load",e)},h=e=>{i.value=!0,t.value=!1,g("error",e)},v=(e,j,y)=>y?y():a(C,{name:e,size:r.iconSize,class:j,classPrefix:r.iconPrefix},null),S=()=>{if(t.value&&r.showLoading)return a("div",{class:o("loading")},[v(r.loadingIcon,o("loading-icon"),n.loading)]);if(i.value&&r.showError)return a("div",{class:o("error")},[v(r.errorIcon,o("error-icon"),n.error)])},b=()=>{if(i.value||!r.src)return;const e={alt:r.alt,class:o("img"),style:{objectFit:r.fit}};return r.lazyLoad?F(a("img",P({ref:c},e),null),[[H("lazy"),r.src]]):a("img",P({src:r.src,onLoad:m,onError:h},e),null)},w=({el:e})=>{e===c.value&&t.value&&m()},I=({el:e})=>{e===c.value&&!i.value&&h()};return s&&E&&(s.$on("loaded",w),s.$on("error",I),k(()=>{s.$off("loaded",w),s.$off("error",I)})),()=>{var e;return a("div",{class:o({round:r.round}),style:x.value},[b(),S(),(e=n.default)==null?void 0:e.call(n)])}}});const K=$(_);export{K as I};
