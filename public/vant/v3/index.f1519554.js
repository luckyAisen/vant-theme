import{c as q,B as J,l as K,h as L,G as _}from"./use-translate.8b8ccbb1.js";import{n as B,m as A,c as O,t as Q,a as W,w as Z}from"./with-install.994557f3.js";import{u as $}from"./use-refs.1bd4ff6f.js";import{u as x}from"./use-touch.b6ff7b52.js";import{I as F}from"./index.bbd0c688.js";import{z as ee,D as te,C as oe,e as f}from"./vue-libs.bf80eadf.js";const[ae,m]=q("rate");function le(t,s,n,r){return t>=s?{status:"full",value:1}:t+.5>=s&&n&&!r?{status:"half",value:.5}:t+1>=s&&n&&r?{status:"half",value:Math.round((t-s+1)*1e10)/1e10}:{status:"void",value:0}}const se={size:B,icon:A("star"),color:String,count:O(5),gutter:B,readonly:Boolean,disabled:Boolean,voidIcon:A("star-o"),allowHalf:Boolean,voidColor:String,touchable:Q,iconPrefix:String,modelValue:W(0),disabledColor:String};var ne=ee({name:ae,props:se,emits:["change","update:modelValue"],setup(t,{emit:s}){const n=x(),[r,v]=$(),p=te(),P=()=>t.readonly||t.disabled||!t.touchable,G=oe(()=>Array(+t.count).fill("").map((o,e)=>le(t.modelValue,e+1,t.allowHalf,t.readonly)));let l,u,h=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;const S=()=>{u=_(p);const o=r.value.map(_);l=[],o.forEach((e,a)=>{h=Math.min(e.top,h),g=Math.max(e.top,g),t.allowHalf?l.push({score:a+.5,left:e.left,top:e.top,height:e.height},{score:a+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:a+1,left:e.left,top:e.top,height:e.height})})},I=(o,e)=>{for(let a=l.length-1;a>0;a--)if(e>=u.top&&e<=u.bottom){if(o>l[a].left&&e>=l[a].top&&e<=l[a].top+l[a].height)return l[a].score}else{const c=e<u.top?h:g;if(o>l[a].left&&l[a].top===c)return l[a].score}return t.allowHalf?.5:1},T=o=>{!t.disabled&&!t.readonly&&o!==t.modelValue&&(s("update:modelValue",o),s("change",o))},X=o=>{P()||(n.start(o),S())},D=o=>{if(!P()&&(n.move(o),n.isHorizontal())){const{clientX:e,clientY:a}=o.touches[0];K(o),T(I(e,a))}},Y=(o,e)=>{const{icon:a,size:c,color:y,count:C,gutter:N,voidIcon:V,disabled:i,voidColor:w,allowHalf:k,iconPrefix:z,disabledColor:E}=t,b=e+1,R=o.status==="full",d=o.status==="void",U=k&&o.value>0&&o.value<1;let H;N&&b!==+C&&(H={paddingRight:L(N)});const j=M=>{S(),T(k?I(M.clientX,M.clientY):b)};return f("div",{key:e,ref:v(e),role:"radio",style:H,class:m("item"),tabindex:i?void 0:0,"aria-setsize":C,"aria-posinset":b,"aria-checked":!d,onClick:j},[f(F,{size:c,name:R?a:V,class:m("icon",{disabled:i,full:R}),color:i?E:R?y:w,classPrefix:z},null),U&&f(F,{size:c,style:{width:o.value+"em"},name:d?V:a,class:m("icon",["half",{disabled:i,full:!d}]),color:i?E:d?w:y,classPrefix:z},null)])};return J(()=>t.modelValue),()=>f("div",{ref:p,role:"radiogroup",class:m({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstart:X,onTouchmove:D},[G.value.map(Y)])}});const me=Z(ne);export{me as R};
